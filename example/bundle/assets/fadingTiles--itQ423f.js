import{W as T,S as C,a as P,O as R,G as D}from"./three.module-CrM3Sdgj.js";import{T as p}from"./TilesFadePlugin--RsjXkIU.js";import{g as S}from"./lil-gui.module.min-C0dNwVk_.js";import{C as F}from"./CameraTransitionManager-DdHYHpwr.js";import{E as x}from"./EnvironmentControls-CC2KExwZ.js";import{T as g}from"./TilesRenderer-DD_LqKmh.js";import"./B3DMLoader-aPf5svSz.js";import"./readMagicBytes-Da5ueiou.js";import"./LoaderBase-CVSPpjX2.js";import"./GLTFLoader-DesqJ6ah.js";import"./PNTSLoader-BKmvYx0Z.js";import"./I3DMLoader-uk6OaXCg.js";import"./CMPTLoader-C0F-2Ze2.js";import"./GLTFExtensionLoader-Cf5SHTW2.js";let d,m,s,e,r,c,a;const t={reinstantiateTiles:f,fadeRootTiles:!0,useFade:!0,errorTarget:12,fadeDuration:.5,renderScale:1,fadingGroundTiles:"0 tiles",orthographic:!1,transitionDuration:.25};E();h();function E(){s=new T({antialias:!0}),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(14208704),document.body.appendChild(s.domElement),m=new C,a=new F(new P(60,window.innerWidth/window.innerHeight,.25,4e3),new R(-1,1,1,-1,0,4e3)),a.camera.position.set(20,10,20),a.camera.lookAt(0,0,0),a.addEventListener("camera-changed",({camera:l,prevCamera:u})=>{r.deleteCamera(u),e.deleteCamera(u),r.setCamera(l),e.setCamera(l),d.setCamera(l)}),d=new x(m,a.camera,s.domElement),d.minZoomDistance=2,d.cameraRadius=1,c=new D,c.rotation.set(Math.PI/2,0,0),m.add(c),f(),w(),window.addEventListener("resize",w,!1);const o=new S,n=o.addFolder("camera");n.add(t,"orthographic").onChange(l=>{a.fixedPoint.copy(d.pivotPoint),a.toggle()}),n.add(t,"transitionDuration",0,1.5);const i=o.addFolder("fade");i.add(t,"useFade"),i.add(t,"fadeRootTiles"),i.add(t,"errorTarget",0,1e3),i.add(t,"fadeDuration",0,5),i.add(t,"renderScale",.1,1,.05).onChange(l=>s.setPixelRatio(l*window.devicePixelRatio));const _=i.add(t,"fadingGroundTiles").listen().disable();_.domElement.style.opacity=1,o.add(t,"reinstantiateTiles"),o.open()}function f(){e&&(e.dispose(),r.dispose()),e=new g("https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize_tileset.json"),e.fetchOptions.mode="cors",e.lruCache.minSize=900,e.lruCache.maxSize=1300,e.errorTarget=12,e.registerPlugin(new p),e.setCamera(a.camera),r=new g("https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_sky/0528_0260184_to_s64o256_sky_tileset.json"),r.fetchOptions.mode="cors",r.lruCache=e.lruCache,r.registerPlugin(new p),r.setCamera(a.camera),c.add(e.group,r.group)}function w(){const{perspectiveCamera:o,orthographicCamera:n}=a,i=window.innerWidth/window.innerHeight;n.bottom=-40,n.top=40,n.left=-40*i,n.right=40*i,n.updateProjectionMatrix(),o.aspect=i,o.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)}function h(){requestAnimationFrame(h),d.enabled=!a.animating,d.update(),a.duration=1e3*t.transitionDuration,a.update();const o=a.camera;o.updateMatrixWorld();const n=e.getPluginByName("FADE_TILES_PLUGIN");n.fadeRootTiles=t.fadeRootTiles,n.fadeDuration=t.useFade?t.fadeDuration*1e3:0,e.errorTarget=t.errorTarget,e.setCamera(o),e.setResolutionFromRenderer(o,s),e.update();const i=r.getPluginByName("FADE_TILES_PLUGIN");i.fadeRootTiles=t.fadeRootTiles,i.fadeDuration=t.useFade?t.fadeDuration*1e3:0,r.setCamera(o),r.setResolutionFromRenderer(o,s),r.update(),s.render(m,o),t.fadingGroundTiles=n.fadingTiles+" tiles"}
