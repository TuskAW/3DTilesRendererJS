class n{constructor({apiToken:s}){this.name="GOOGLE_CLOUD_AUTH_PLUGIN",this.apiToken=s,this.sessionToken=null,this.tiles=null,this._onLoadCallback=null,this._visibilityChangeCallback=null}init(s){this.tiles=s,this._onLoadCallback=()=>{s.traverse(e=>e.content&&e.content.uri?(this.sessionToken=new URL(e.content.uri,e.__basePath).searchParams.get("session"),!0):!1),s.removeEventListener("load-tile-set",this._onLoadCallback)},s.addEventListener("load-tile-set",this._onLoadCallback)}preprocessURL(s){return s=new URL(s),/^http/.test(s.protocol)&&(s.searchParams.append("key",this.apiToken),this.sessionToken!==null&&s.searchParams.append("session",this.sessionToken)),s.toString()}dispose(){this.tiles.removeEventListener("load-tile-set",this._onLoadCallback)}}export{n as G};
